# PacketSanitizer: Packet Buffer Detection Guide\n\n## What's New?\n\nPacketSanitizer now automatically detects when you have packets loaded in Wireshark and can sanitize them directly‚Äîwithout requiring you to select a file through a dialog!\n\n## How It Works\n\nWhen you click on a PacketSanitizer sanitization mode:\n\n1. **Packet Detection** - The plugin checks if you have packets loaded in Wireshark\n2. **Automatic Processing** - If packets are found, they're processed immediately\n3. **File Dialog (if needed)** - Only appears if no packets are detected\n\n## Quick Start\n\n### Sanitizing Packets Currently in Wireshark\n\n#### Active Capture\n1. Start capturing packets in Wireshark\n2. When ready, go to **Tools ‚Üí PacketSanitizer** and select your mode\n3. The buffered packets are automatically sanitized\n4. Click **Open File** to view the sanitized capture\n\n#### Loaded PCAP File\n1. Open a PCAP/PCAPNG file in Wireshark\n2. Go to **Tools ‚Üí PacketSanitizer** and select your mode\n3. The packets from the file are automatically sanitized\n4. Click **Open File** to view the sanitized version\n\n### If No Packets Are Detected\nIf Wireshark doesn't have any packets loaded:\n- A file dialog will appear (the same as before)\n- Select your PCAP/PCAPNG file\n- Sanitization proceeds normally\n\n## Sanitization Modes\n\nChoose the mode that matches your security needs:\n\n### üîí Sanitize All Payload\n- **Removes**: All TCP, UDP, and ICMP payload data\n- **Preserves**: IP addresses, MAC addresses, protocol headers\n- **Best for**: Analyzing network flows while hiding payload content\n- **Output file**: `*_sanitized_payload.pcap`\n\n### üîí Sanitize Clear Text Payload\n- **Removes**: Payloads from plaintext protocols only (HTTP, FTP, Telnet, SMTP, POP3, IMAP, DNS)\n- **Preserves**: Encrypted traffic (HTTPS, SSH, TLS), IP addresses, MAC addresses\n- **Best for**: Removing sensitive data while keeping encrypted communication analysis possible\n- **Output file**: `*_sanitized_cleartext.pcap`\n\n### üîíüîí Sanitize Payload and IP & MAC Addresses\n- **Removes**: All payloads, all IP addresses, all MAC addresses, DHCP data\n- **Preserves**: Protocol structure, port numbers, packet timing\n- **Best for**: Maximum privacy‚Äîsafe to share outside your organization\n- **Output file**: `*_sanitized_full.pcap`\n\n## Output Files\n\nSanitized files are created with a suffix indicating the mode:\n\n| Original File | Mode | Output File |\n|---|---|---|\n| `capture.pcap` | All Payload | `capture_sanitized_payload.pcap` |\n| `capture.pcap` | Clear Text | `capture_sanitized_cleartext.pcap` |\n| `capture.pcap` | Full | `capture_sanitized_full.pcap` |\n\n**Original file is never modified** ‚Äî a new sanitized copy is always created.\n\n## Viewing Results\n\nAfter sanitization completes:\n\n1. A success message appears with details:\n   - **Mode**: Which sanitization mode was used\n   - **Source**: Where the packets came from (buffer or file)\n   - **Output**: Path to the sanitized file\n\n2. Click **Open File** to load the sanitized capture in Wireshark\n\n3. Or close the window and open the file manually later\n\n## Platform-Specific Notes\n\n### macOS\n- Packets are detected from the current Wireshark capture/file\n- Sanitized files are created in the same directory as the source\n- Check the success message for exact output file location\n\n### Linux\n- Works with any Wireshark installation\n- Output files go to the same location as source files\n- Requires Python 3 and Scapy library\n\n### Windows\n- Automatic detection works with Wireshark captures and loaded files\n- Check the success dialog for output location\n- Output files use `.pcap` format by default\n\n## Troubleshooting\n\n### \"File Dialog Appears When I Have Packets Loaded\"\n**Possible causes:**\n- Wireshark hasn't fully loaded the capture file yet‚Äîwait a moment\n- The file doesn't contain any packets\n- Buffer detection encountered an issue\n\n**Solution:** You can still proceed by selecting the file from the dialog\n\n### \"File Not Found\" After Sanitization\n- Check the success message for the exact output path\n- The file is created in the same directory as the source\n- Windows: Check `C:\\Users\\YourName\\...` (from the success message)\n- macOS/Linux: Check the path shown in the success message\n\n### \"Python Not Found\" or \"Scapy Missing\"\n- Install Python 3: `python3 --version`\n- Install Scapy: `pip3 install scapy`\n- Restart Wireshark\n\n## What Gets Sanitized?\n\n### All Modes Sanitize\n- ‚úÖ TCP/UDP/ICMP payloads (replaced with \"SA\" pattern)\n- ‚úÖ DHCP layer information (removed)\n- ‚úÖ Sensitive protocol data\n\n### Full Sanitization Mode Also Sanitizes\n- ‚úÖ IP addresses (replaced with 10.0.0.0/8 range)\n- ‚úÖ MAC addresses (replaced with locally-administered MACs)\n- ‚úÖ All conversation identifiers\n\n### What's Always Preserved\n- ‚úì Packet structure and size (for analysis)\n- ‚úì Protocol headers and types\n- ‚úì Port numbers\n- ‚úì Packet timing and sequences\n- ‚úì Network flow patterns\n\n## Privacy & Security\n\n‚úÖ **Safe to Share:**\n- Sanitized files can be safely shared outside your organization\n- No sensitive credentials or data in payloads\n- No real IP/MAC addresses (in full sanitization mode)\n\n‚ö†Ô∏è **Review Before Sharing:**\n- Port numbers and timing may reveal system behavior\n- Protocol types are still visible\n- Network topology is partially visible (especially in payload/cleartext modes)\n- Consider your security requirements before sharing\n\n## Command Line Usage\n\nYou can also sanitize files from the command line:\n\n```bash\npython3 sanitize_packets.py <mode> <input_file> <output_file>\n```\n\n**Modes:**\n- `all_payload` - Sanitize all payloads\n- `cleartext_payload` - Sanitize only plaintext protocol payloads\n- `payload_and_addresses` - Full sanitization (recommended)\n\n**Example:**\n```bash\npython3 sanitize_packets.py payload_and_addresses capture.pcap shared_capture.pcap\n```\n\n## Questions or Issues?\n\nRefer to the main README.md for:\n- Detailed installation instructions\n- Technical specifications\n- Plain text protocol list\n- Advanced usage examples\n- Contributing guidelines\n"